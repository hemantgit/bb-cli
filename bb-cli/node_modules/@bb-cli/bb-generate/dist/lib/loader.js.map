{"version":3,"sources":["../../src/lib/loader.js"],"names":["checkInputTemplatePath","templateFilePath","loadGenerator","templateFilePathParam","verbose","generatorModule","require","generatorFactory","api","preset","prompt","dirName","dirname","err","type","message"],"mappings":";;;;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;;;AAEA;AACA,IAAMA,yBAAyB,SAAzBA,sBAAyB;AAAA,SAAoBC,gBAApB;AAAA,CAA/B;;AAEA,IAAMC,gBAAgB,SAAhBA,aAAgB,CAACC,qBAAD,EAA2B;AAC/C,YAAIC,OAAJ,CAAY,MAAZ,kBAAkCD,qBAAlC;;AAEA,MAAMF,mBAAmBD,uBAAuBG,qBAAvB,CAAzB;AACA,MAAI;AACF,QAAME,kBAAkBC,QAAQL,gBAAR,CAAxB,CADE,CACiD;AACnD,QAAMM,mBAAoB,+BAAkBF,eAAlB,CAAD,GACrB,oCAAuBA,eAAvB,CADqB,GACqBA,eAD9C;AAEA,QAAMG,MAAMD,yCAA+B,uBAAaE,MAA5C,EAAoD,SAAGC,MAAvD,CAAZ;AACAF,QAAIG,OAAJ,GAAe,kBAAMV,gBAAN,CAAD,GAA4BA,gBAA5B,GAA+C,eAAKW,OAAL,CAAaX,gBAAb,CAA7D;AACA,WAAOO,GAAP;AACD,GAPD,CAOE,OAAOK,GAAP,EAAY;AACZ,UAAM,iBAAM;AACVC,YAAM,kBADI;AAEVC,eAASF,IAAIE;AAFH,KAAN,CAAN;AAID;AACF,CAjBD;;kBAmBeb,a;QAEbA,a,GAAAA,a","file":"loader.js","sourcesContent":["\nimport path from 'path';\nimport { log, ui, error } from '@bb-cli/base';\nimport { isDir } from './utils';\nimport { isLegacyGenerator, convertLegacyGenerator } from './legacy';\nimport generatorAPI from './generator-api';\n\n// todo resolve path to default index.js if is not passed\nconst checkInputTemplatePath = templateFilePath => templateFilePath;\n\nconst loadGenerator = (templateFilePathParam) => {\n  log.verbose('LOAD', `loading... ${templateFilePathParam}`);\n\n  const templateFilePath = checkInputTemplatePath(templateFilePathParam);\n  try {\n    const generatorModule = require(templateFilePath); // eslint-disable-line global-require\n    const generatorFactory = (isLegacyGenerator(generatorModule)) ?\n        convertLegacyGenerator(generatorModule) : generatorModule;\n    const api = generatorFactory(generatorAPI, generatorAPI.preset, ui.prompt);\n    api.dirName = (isDir(templateFilePath)) ? templateFilePath : path.dirname(templateFilePath);\n    return api;\n  } catch (err) {\n    throw error({\n      type: 'E_GENERATOR_LOAD',\n      message: err.message,\n    });\n  }\n};\n\nexport default loadGenerator;\nexport {\n  loadGenerator,\n};\n"]}